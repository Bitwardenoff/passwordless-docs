# Backend Language Examples

You can use Passwordless.dev with any programming language by implementing calls to the Passwordless.dev API, but this document will provide some code examples, guidelines, and other help integrating Passwordless.dev with popular languages.

## ASP.NET Core

This ASP.NET Core implementation uses .NET 7 and some JavaScript for a simple passwordless.dev implementation. A [register](api/#register-token) function might look something like:


```csharp
[HttpGet("/create-token")]
public async Task<IActionResult> GetRegisterToken(string alias)
{
    var userId = Guid.NewGuid().ToString();
    var payload = new
    {
        userId,
        username = alias,
        Aliases = new[] { alias }
    };

    var request = await _httpClient.PostAsJsonAsync("register/token", payload);

    if (request.IsSuccessStatusCode)
    {
        var token = await request.Content.ReadFromJsonAsync<TokenResponse>();
        return Ok(token);
    }

    // Handle or log any API error, { errorCode: "unknown_credentials", "title": "This is what is wrong", "details": "..."}
    var error = await request.Content.ReadFromJsonAsync<ProblemDetails>();    
    return new JsonResult(error)
    {
        StatusCode = (int)request.StatusCode
    };
}
```


[Open the ASP.NET example on Github](https://github.com/passwordless/passwordless-dotnet-example).

## Node.js

This Node.js implementation is done in only a few lines of code. A [register](api/#register-token) function might look something like:

```js
app.get("/create-token", async (req, res) => {

  const alias = req.query.alias;
  
  // Generate a new userid or grab the userid from session, cookie etc
  const payload = {
    userId: getRandomInt(),
    username: alias,
    aliases: [alias] // We can also set aliases for the userid, so that signin can be initiated without knowing the userid
  };

  // Send the username to the passwordless api to get a token
  var response = await fetch("https://v4.passwordless.dev/register/token", {
    method: "POST",
    body: JSON.stringify(payload),
    headers: { ApiSecret: API_SECRET, 'Content-Type': 'application/json'}
  });

  var responseData = await response.json();
  console.log("passwordless api response", response.status, response.statusText, responseData);
    
  if(response.status == 200) {
    console.log("received token: ", responseData.token);
  } else {
    // Handle or log any API error, { errorCode: "unknown_credentials", "title": "This is what is wrong", "details": "..."}
  }

  res.status(response.status);
  res.send(responseData);
});
```

[Open the Node.js example on Github](https://github.com/passwordless/passwordless-nodejs-example)

If you just want to see the Node.js demo run, we host an example at [demo-backend.passwordless.dev](https://demo-backend.passwordless.dev/)

## PHP
This PHP implementation is compatible with PHP 5.6 and above. However, it is important to note that the curl library may not be available in older versions of PHP. Therefore, you may need to update your PHP installation if you are using an older version. A [register](https://docs.passwordless.dev/guide/api/#register-token) function might look something like:
```php
<?php

// Define the API secret key used for authentication with the remote server
$API_SECRET = "YOUR_API_SECRET";

// Function to generate a random integer value
function get_random_int() {
  // Multiply the random number generated by mt_rand() by 1e9 (one billion) and return the integer value
  return intval(1e9 * mt_rand());
}

// Function to create a token using the given alias
function create_token($alias) {
  global $API_SECRET; // Make the API secret accessible inside the function

  // Prepare the payload for the API request, including the user ID, username, and aliases
  $payload = array(
    "userId" => get_random_int(),
    "username" => $alias,
    "aliases" => array($alias)
  );

  // Initialize a cURL session
  $ch = curl_init();
  // Set the URL of the remote server
  curl_setopt($ch, CURLOPT_URL, "https://v4.passwordless.dev/register/token");
  // Indicate that this is a POST request
  curl_setopt($ch, CURLOPT_POST, 1);
  // Attach the JSON-encoded payload as the POST data
  curl_setopt($ch, CURLOPT_POSTFIELDS, json_encode($payload));
  // Set the HTTP headers, including the API secret and content type
  curl_setopt($ch, CURLOPT_HTTPHEADER, array("ApiSecret: $API_SECRET", "Content-Type: application/json"));
  // Return the response as a string instead of printing it
  curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);
  // Optionally, disable SSL certificate verification (not recommended for production)
  // curl_setopt($ch, CURLOPT_SSL_VERIFYPEER, false);

  // Execute the cURL request and store the response
  $response = curl_exec($ch);

  // Check for cURL errors and print them if any
  if (curl_errno($ch)) {
      print("cURL error: " . curl_error($ch) . "\n");
  }

  // Get the HTTP response code
  $response_code = curl_getinfo($ch, CURLINFO_HTTP_CODE);

  // Close the cURL session
  curl_close($ch);

  // Print the API response code
  print("passwordless api response: " . $response_code . "\n");

  // Decode the JSON response into an associative array
  $response_data = json_decode($response, true);
  print_r($response_data);

  // Check if the response code is 200 (Success) and print the received token
  if ($response_code == 200) {
    print("received token: " . $response_data["token"] . "\n");
  } else {
    // Handle or log any API error
    // Log or handle the error as needed in this block
  }

  // Return the response data
  return $response_data;
}

// Check if the script is executed with exactly one argument
if ($argc == 2) {
  // Get the alias from the command-line argument
  $alias = $argv[1];
  // Call the create_token function with the alias and store the response
  $response_data = create_token($alias);
} else {
  // Print the usage instruction if the script is not executed with the correct number of arguments
  print("Usage: create_token.php <alias>\n");
}

?>


```



## Python 3.8+
This Python 3.8+ implementation is done in only a few lines of code. A [register](https://docs.passwordless.dev/guide/api/#register-token) function might look something like:
```python
import requests  # Import the requests library for making HTTP requests
import json      # Import the json library for working with JSON data
import random    # Import the random library to generate random numbers

# Define the API secret key used for authentication with the remote server
API_SECRET = "YOUR_API_SECRET"

# Function to generate a random integer value
def get_random_int():
  # Multiply a random float (0 to 1) by 1e9 (one billion) and return the integer value
  return int(1e9 * random.random())

# Function to create a token using the given alias
def create_token(alias):
  # Prepare the payload for the API request, including the user ID, username, and aliases
  payload = {
    "userId": get_random_int(),
    "username": alias,
    "aliases": [alias]
  }

  # Make a POST request to the specified URL, sending the payload as JSON, and including headers for the API secret and content type
  response = requests.post("https://v4.passwordless.dev/register/token", json=payload, headers={"ApiSecret": API_SECRET, "Content-Type": "application/json"})

  # Decode the JSON response into a Python dictionary
  response_data = response.json()

  # Print the response status code, text, and data
  print("passwordless api response", response.status_code, response.text, response_data)

  # Check if the response status code is 200 (Success) and print the received token
  if response.status_code == 200:
    print("received token: ", response_data["token"])
  else:
    # Handle or log any API error
    # Add error handling or logging code here if needed
    pass

  # Return the response data
  return response_data

# Check if the script is being run as the main module
if __name__ == "__main__":
  # Call the create_token function with the alias "alias" and store the response
  response_data = create_token("alias")

```
[Open the example Python 3.8+ application using Flask on GitHub
](https://github.com/passwordless/sdk-collection/tree/main/Python%203.8-Flask)
## Python 2.7+
This Python 2.7+ implementation is done in only a few lines of code. A [register](https://docs.passwordless.dev/guide/api/#register-token) function might look something like:

```python
import requests       # Import the requests library for making HTTP requests
import simplejson as json # Import the simplejson library and alias it as json for working with JSON data
import random        # Import the random library to generate random numbers

# Define the API secret key used for authentication with the remote server
API_SECRET = "YOUR_API_SECRET"

# Function to generate a random integer value
def get_random_int():
  # Multiply a random float (0 to 1) by 1e9 (one billion) and return the integer value
  return int(1e9 * random.random())

# Function to create a token using the given alias
def create_token(alias):
  # Prepare the payload for the API request, including the user ID, username, and aliases
  payload = {
    "userId": get_random_int(),
    "username": alias,
    "aliases": [alias]
  }

  # Convert the payload to a JSON string using simplejson's dumps method
  payload_json = json.dumps(payload)

  # Make a POST request to the specified URL, sending the JSON payload as data, and including headers for the API secret and content type
  response = requests.post("https://v4.passwordless.dev/register/token", data=payload_json, headers={"ApiSecret": API_SECRET, "Content-Type": "application/json"})

  # Load the JSON response content into a Python dictionary using simplejson's loads method
  response_data = json.loads(response.content)

  # Print the response status code, text, and data
  print("passwordless api response", response.status_code, response.text, response_data)

  # Check if the response status code is 200 (Success) and print the received token
  if response.status_code == 200:
    print("received token: ", response_data["token"])
  else:
    # Handle or log any API error
    # Add error handling or logging code here if needed
    pass

  # Return the response data
  return response_data

# Check if the script is being run as the main module
if __name__ == "__main__":
  # Call the create_token function with the alias "alias" and store the response
  response_data = create_token("alias")

```
## Java 1.8+
This Java implementation is compatible with Java 1.8+ and above. A [register](https://docs.passwordless.dev/guide/api/#register-token) function might look something like:
```java
import java.io.IOException;
import java.io.InputStream;
import java.io.PrintWriter;
import java.net.HttpURLConnection;
import java.net.URL;
import java.util.Scanner;

public class CreateToken {

    // Define the API secret key used for authentication with the remote server
    private static final String API_SECRET = "YOUR_API_SECRET";

    public static void main(String[] args) throws IOException {
        // Get the alias from the command-line argument
        String alias = args[0];

        // Create a URL object with the target URL
        URL url = new URL("https://v4.passwordless.dev/register/token");
        // Open an HTTP connection to the specified URL
        HttpURLConnection connection = (HttpURLConnection) url.openConnection();
        // Set the request method to POST
        connection.setRequestMethod("POST");
        // Set the request headers for the API secret and content type
        connection.setRequestProperty("ApiSecret", API_SECRET);
        connection.setRequestProperty("Content-Type", "application/json");

        // Build the JSON payload for the request as a string
        String payload = "{" +
                "  \"userId\": " + getRandomInt() + "," +
                "  \"username\": \"" + alias + "\", " +
                "  \"aliases\": [\"" + alias + "\"]" +
                "}";

        // Enable output for the connection to allow writing data
        connection.setDoOutput(true);
        // Write the payload to the connection's output stream using a PrintWriter
        try (PrintWriter writer = new PrintWriter(connection.getOutputStream())) {
            writer.print(payload);
        }

        // Get the response code and response message from the connection
        int responseCode = connection.getResponseCode();
        String responseMessage = connection.getResponseMessage();
        // Get the response content as an input stream
        InputStream responseInputStream = connection.getInputStream();

        // Read the response content using a Scanner
        Scanner scanner = new Scanner(responseInputStream);
        String responseData = scanner.nextLine();

        // Print the response code, message, and data
        System.out.println("passwordless api response: " + responseCode + " " + responseMessage + " " + responseData);

        // Check if the response code is 200 (Success) and print the received token
        if (responseCode == 200) {
            System.out.println("received token: " + responseData);
        } else {
            // Handle or log any API error
            // Add error handling or logging code here if needed
        }
    }

    // Function to generate a random integer value
    private static int getRandomInt() {
        // Multiply a random float (0 to 1) by 1e9 (one billion) and return the integer value
        return (int) (1e9 * Math.random());
    }
}

```
